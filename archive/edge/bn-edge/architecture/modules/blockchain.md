---
id: blockchain
title: ржмрзНрж▓ржХржЪрзЗржЗржи
description: Polygon Edge-ржПрж░ ржмрзНрж▓ржХржЪрзЗржЗржи ржПржмржВ рж╕рзНржЯрзЗржЯ ржоржбрж┐ржЙрж▓рзЗрж░ ржмрзНржпрж╛ржЦрзНржпрж╛ред
keywords:
  - docs
  - polygon
  - edge
  - architecture
  - module
  - blockchain
  - state
---

## рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржмрж┐ржмрж░ржг {#overview}

Polygon Edge-ржПрж░ ржЕржирзНржпрждржо ржкрзНрж░ржзрж╛ржи ржоржбрж┐ржЙрж▓ рж╣ржЪрзНржЫрзЗ **ржмрзНрж▓ржХржЪрзЗржЗржи** ржПржмржВ **рж╕рзНржЯрзЗржЯ**ред <br />

**ржмрзНрж▓ржХржЪрзЗржЗржи** ржЦрзБржмржЗ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржПржХржЯрж┐ ржмрж╕рзНрждрзБ ржпрж╛ ржмрзНрж▓ржХ ржкрзБржирж░рзНржмрж┐ржирзНржпрж╛рж╕рзЗрж░ ржХрж╛ржЬржЯрж┐ рж╕ржорзНржкржирзНржи ржХрж░рзЗ ржерж╛ржХрзЗред ржПрж░ ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ ржпрзЗ ржмрзНрж▓ржХржЪрзЗржЗржирзЗ ржХрзЛржирзЛ ржирждрзБржи ржмрзНрж▓ржХ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рж╛рж░ рж╕ржорзЯ ржПржЯрж┐ рж╕ржХрж▓ рж▓ржЬрж┐ржХ рж╕ржВржХрзНрж░рж╛ржирзНржд ржХрж╛ржЬржЧрзБрж▓рзЛ рж╕ржорзНржкржирзНржи ржХрж░рзЗ ржерж╛ржХрзЗред

**рж╕рзНржЯрзЗржЯ** *рж╕рзНржЯрзЗржЯ ржЯрзНрж░рж╛ржиржЬрж┐рж╢ржи* ржЕржмржЬрзЗржХрзНржЯрзЗрж░ ржкрзНрж░рждрж┐ржирж┐ржзрж┐рждрзНржм ржХрж░рзЗред ржПржЯрж┐ ржирждрзБржи ржмрзНрж▓ржХ ржЕржирзНрждрзБрж░рзНржнрзБржХрзНржд ржХрж░рж╛ рж╣рж▓рзЗ рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржмрж┐рж╖рзЯржЯрж┐ржХрзЗ ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рзЗ ржерж╛ржХрзЗред <br />ржЕржирзНржпрж╛ржирзНржп ржХрж╛ржЬрзЗрж░ ржоржзрзНржпрзЗ, **рж╕рзНржЯрзЗржЯ** ржирж┐ржорзНржирж▓рж┐ржЦрж┐рждржЧрзБрж▓рзЛржУ рж╕ржорзНржкрж╛ржжржи ржХрж░рзЗ ржерж╛ржХрзЗ:
* рж▓рзЗржиржжрзЗржи ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ ржХрж░рж╛
* EVM ржПржХрзНрж╕рж┐ржХрж┐ржЙржЯ ржХрж░рж╛
* Merkle ржЯрзНрж░рж┐ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛
* ржЖрж░ржУ ржЕржирзЗржХ ржХрж┐ржЫрзБ рж╕ржорзНржкрж╛ржжржи ржХрж░рзЗ ржерзЗржХрзЗ, ржпрж╛ рж╕ржВрж╢рзНрж▓рж┐рж╖рзНржЯ **рж╕рзНржЯрзЗржЯ** ржмрж┐ржнрж╛ржЧрзЗ ржмрж░рзНржгржирж╛ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ ЁЯЩВ

ржорзВрж▓ ржмрж┐рж╖рзЯ рж╣ржЪрзНржЫрзЗ ржПржЗ 2ржЯрж┐ ржЕржВрж╢ ржПржХрж╕рж╛ржерзЗ рж╕ржВржпрзБржХрзНржд ржПржмржВ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯрзЗ ржХрж░рзНржоржХрзНрж╖ржорждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рждрзЗ ржПржЗржЧрзБрж▓рзЛ ржПржХрж╕рж╛ржерзЗ ржЦрзБржмржЗ ржШржирж┐рж╖рзНржЯржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред <br /> ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржпржЦржи **ржмрзНрж▓ржХржЪрзЗржЗржи** рж▓рзЗрзЯрж╛рж░ ржПржХржЯрж┐ ржирждрзБржи ржмрзНрж▓ржХ ржкрж╛рзЯ (ржПржмржВ ржХрзЛржиржУ ржкрзБржирж░рзНржмрж┐ржирзНржпрж╛рж╕ ржирж╛ ржХрж░рждрзЗ рж╣рзЯ), ржПржЯрж┐ ржПржХржЯрж┐ рж╕рзНржЯрзЗржЯ ржЯрзНрж░рж╛ржиржЬрж┐рж╢ржи рж╕ржорзНржкрж╛ржжржи ржХрж░рж╛рж░ ржЬржирзНржп **рж╕рзНржЯрзЗржЯ** ржХрж▓ ржХрж░рзЗред

**ржмрзНрж▓ржХржЪрзЗржЗржи** ржХржирж╕рзЗржирж╕рж╛рж╕ рж╕ржВржХрзНрж░рж╛ржирзНржд ржХрж┐ржЫрзБ ржмрж┐рж╖рзЯржУ ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рзЗ ржерж╛ржХрзЗ (ржпрзЗржоржи, *ржПржЗ ethHash ржХрж┐ рж╕ржарж┐ржХ?*, *ржПржЗ PoW ржХрж┐ рж╕ржарж┐ржХ?*)ред <br /> рж╕ржВржХрзНрж╖рзЗржкрзЗ, **ржПржЯрж┐ рж▓ржЬрж┐ржХрзЗрж░ ржкрзНрж░ржзрж╛ржи ржХрзЛрж░ ржпрж╛рждрзЗ рж╕ржорж╕рзНржд ржмрзНрж▓ржХ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржерж╛ржХрзЗ**ред

## *WriteBlocks*

ржмрзНрж▓ржХржЪрзЗржЗржи рж▓рзЗрзЯрж╛рж░ рж╕ржорзНржкрж░рзНржХрж┐ржд рж╕ржмржЪрзЗржпрж╝рзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЕржВрж╢ рж╣ржЪрзНржЫрзЗ **WriteBlocks**** ржкржжрзНржзрждрж┐:

````go title="blockchain/blockchain.go"
// WriteBlocks writes a batch of blocks
func (b *Blockchain) WriteBlocks(blocks []*types.Block) error {
	if len(blocks) == 0 {
		return fmt.Errorf("no headers found to insert")
	}

	parent, ok := b.readHeader(blocks[0].ParentHash())
	if !ok {
		return fmt.Errorf("parent of %s (%d) not found: %s", blocks[0].Hash().String(), blocks[0].Number(), blocks[0].ParentHash())
	}

	// validate chain
	for i := 0; i < len(blocks); i++ {
		block := blocks[i]

		if block.Number()-1 != parent.Number {
			return fmt.Errorf("number sequence not correct at %d, %d and %d", i, block.Number(), parent.Number)
		}
		if block.ParentHash() != parent.Hash {
			return fmt.Errorf("parent hash not correct")
		}
		if err := b.consensus.VerifyHeader(parent, block.Header, false, true); err != nil {
			return fmt.Errorf("failed to verify the header: %v", err)
		}

		// verify body data
		if hash := buildroot.CalculateUncleRoot(block.Uncles); hash != block.Header.Sha3Uncles {
			return fmt.Errorf("uncle root hash mismatch: have %s, want %s", hash, block.Header.Sha3Uncles)
		}
		
		if hash := buildroot.CalculateTransactionsRoot(block.Transactions); hash != block.Header.TxRoot {
			return fmt.Errorf("transaction root hash mismatch: have %s, want %s", hash, block.Header.TxRoot)
		}
		parent = block.Header
	}

	// Write chain
	for indx, block := range blocks {
		header := block.Header

		body := block.Body()
		if err := b.db.WriteBody(header.Hash, block.Body()); err != nil {
			return err
		}
		b.bodiesCache.Add(header.Hash, body)

		// Verify uncles. It requires to have the bodies on memory
		if err := b.VerifyUncles(block); err != nil {
			return err
		}
		// Process and validate the block
		if err := b.processBlock(blocks[indx]); err != nil {
			return err
		}

		// Write the header to the chain
		evnt := &Event{}
		if err := b.writeHeaderImpl(evnt, header); err != nil {
			return err
		}
		b.dispatchEvent(evnt)

		// Update the average gas price
		b.UpdateGasPriceAvg(new(big.Int).SetUint64(header.GasUsed))
	}

	return nil
}
````
*WriteBlocks* ржкржжрзНржзрждрж┐ рж╣ржЪрзНржЫрзЗ ржмрзНрж▓ржХржЪрзЗржЗржирзЗ ржмрзНрж▓ржХ рж▓рж┐ржЦрж╛рж░ ржПржирзНржЯрзНрж░рж┐ ржкржпрж╝рзЗржирзНржЯред ржПржХржЯрж┐ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ рж╣рж┐рж╕рж╛ржмрзЗ, ржПржЯрж┐ ржмрзНрж▓ржХрзЗрж░ ржкрж░рж┐рж╕рзАржорж╛ ржирж┐рзЯрзЗ ржерж╛ржХрзЗред <br />
ржкрзНрж░ржержоржд, ржмрзНрж▓ржХ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛ рж╣ржпрж╝ред рждрж╛рж░ржкрж░, рждрж╛ржжрзЗрж░ ржЪрзЗржЗржирзЗ рж▓рж┐ржЦрж╛ рж╣рзЯред

ржкрзНрж░ржХрзГржд *рж╕рзНржЯрзЗржЯ ржЯрзНрж░рж╛ржиржЬрж┐рж╢ржи* *WriteBlocks*-ржПрж░ ржоржзрзНржпрзЗ *processBlock* ржкржжрзНржзрждрж┐ ржХрж▓ ржХрж░рзЗ рж╕ржорзНржкрж╛ржжржи ржХрж░рж╛ рж╣рзЯред

ржПржЫрж╛рзЬрж╛ржУ, ржпрзЗрж╣рзЗрждрзБ ржПржЯрж┐ ржмрзНрж▓ржХржЪрзЗржЗржирзЗ ржмрзНрж▓ржХ рж▓рзЗржЦрж╛рж░ ржПржирзНржЯрзНрж░рж┐ ржкржпрж╝рзЗржирзНржЯ, рждрж╛ржЗ ржЕржирзНржпрж╛ржирзНржп ржоржбрж┐ржЙрж▓ржЧрзБрж▓рзЛржУ (ржпрзЗржоржи **Sealer**) ржПржЗ ржкржжрзНржзрждрж┐рж░ рж╕рзБржмрж┐ржзрж╛ ржЧрзНрж░рж╣ржг ржХрж░рзЗ ржерж╛ржХрзЗред

## ржмрзНрж▓ржХржЪрзЗржЗржи рж╕рж╛ржмрж╕рзНржХрзНрж░рж┐ржкрж╢ржи {#blockchain-subscriptions}

ржмрзНрж▓ржХржЪрзЗржЗржи-рж╕ржВржХрзНрж░рж╛ржирзНржд ржкрж░рж┐ржмрж░рзНрждржи ржоржирж┐ржЯрж░ ржХрж░рж╛рж░ ржПржХржЯрж┐ ржорзЗржХрж╛ржирж┐ржЬржо ржерж╛ржХрж╛ ржЦрзБржмржЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржгред <br />
**рж╕рж╛ржмрж╕рзНржХрзНрж░рж┐ржкрж╢ржи** ржарж┐ржХ рж╕рзЗржЗ ржХрж╛ржЬржЯрж┐ржЗ рж╕ржорзНржкрж╛ржжржи ржХрж░рзЗ ржерж╛ржХрзЗред

рж╕рж╛ржмрж╕рзНржХрзНрж░рж┐ржкрж╢ржи рж╣ржЪрзНржЫрзЗ ржмрзНрж▓ржХржЪрзЗржЗржи ржЗржнрзЗржирзНржЯ рж╕рзНржЯрзНрж░рж┐ржорзЗ ржШрзБрж░рзЗ ржЖрж╕рж╛рж░ ржПржмржВ ржЕржмрж┐рж▓ржорзНржмрзЗ ржХрж╛рж░рзНржпржХрж░рзА ржбрзЗржЯрж╛ ржкрж╛ржУрзЯрж╛рж░ ржПржХржЯрж┐ ржЙржкрж╛рзЯред

````go title="blockchain/subscription.go"
type Subscription interface {
    // Returns a Blockchain Event channel
	GetEventCh() chan *Event
	
	// Returns the latest event (blocking)
	GetEvent() *Event
	
	// Closes the subscription
	Close()
}
````

**ржмрзНрж▓ржХржЪрзЗржЗржи ржЗржнрзЗржирзНржЯрзЗ** ржкрзНрж░ржХрзГржд ржЪрзЗржЗржи ржХрж░рж╛ рж╕ржХрж▓ ржкрж░рж┐ржмрж░рзНрждржи рж╕ржВржХрзНрж░рж╛ржирзНржд рждржерзНржп рж░ржпрж╝рзЗржЫрзЗред ржПрждрзЗ ржкрзБржирж░рзНржмрж┐ржирзНржпрж╛рж╕рзЗрж░ ржкрж╛рж╢рж╛ржкрж╛рж╢рж┐ ржирждрзБржи ржмрзНрж▓ржХржУ ржЕржирзНрждрж░рзНржнрзБржХрзНржд рж░рзЯрзЗржЫрзЗ:

````go title="blockchain/subscription.go"
type Event struct {
	// Old chain removed if there was a reorg
	OldChain []*types.Header

	// New part of the chain (or a fork)
	NewChain []*types.Header

	// Difficulty is the new difficulty created with this event
	Difficulty *big.Int

	// Type is the type of event
	Type EventType

	// Source is the source that generated the blocks for the event
	// right now it can be either the Sealer or the Syncer. TODO
	Source string
}
````

:::tip рж░рж┐ржлрзНрж░рзЗрж╢рж╛рж░

ржЖржкржирж╛рж░ ржХрж┐ ржоржирзЗ ржЖржЫрзЗ ржХржЦржи ржЖржорж░рж╛ [CLI ржХржорж╛ржирзНржбрзЗ](/docs/edge/get-started/cli-commands) ***ржоржирж┐ржЯрж░*** ржХржорж╛ржирзНржб ржЙрж▓рзНрж▓рзЗржЦ ржХрж░рзЗржЫрж┐?

ржмрзНрж▓ржХржЪрзЗржЗржи ржЗржнрзЗржирзНржЯржЧрзБрж▓рзЛ рж╣ржЪрзНржЫрзЗ Polygon Edge-ржП ржШржЯрж╛ ржорзВрж▓ ржЗржнрзЗржирзНржЯ ржПржмржВ рж╕рж╣ржЬрзЗ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░рзЗрж░ ржЬржирзНржп рж╕рзЗржЧрзБрж▓рзЛржХрзЗ ржкрж░рзЗ ржкрзНрж░рзЛржЯрзЛржХрж▓ ржмрж╛ржлрж╛рж░ ржорзЗрж╕рзЗржЬ ржлрж░ржорзНржпрж╛ржЯрзЗ ржорзНржпрж╛ржк ржХрж░рж╛ рж╣рзЯред

:::