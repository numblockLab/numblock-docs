---
id: definitions
title: Общие определения
description: Общие определения терминов, используемых в chainBridge
keywords:
  - docs
  - polygon
  - edge
  - Bridge
---


## Ретранслятор {#relayer}
Chainbridge — это мост ретрансляторного типа. Роль ретранслятора заключается в голосовании за исполнение заявки (например, сколько токенов сжечь/выпустить). Он отслеживает события из каждой цепочки и при получении `Deposit`события из цепочки и голосует за предложение в контракте Bridge конечной цепочки. Ретранслятор вызывает метод в контракте Bridge для исполнения предложения после отправки требуемого количества голосов. Мост делегирует исполнение контракту Handler.


## Типы контрактов {#types-of-contracts}
В ChainBridge существует три типа контрактов в каждой цепочке, они называются Bridge/Handler/Target.

| **Тип** | **Описание** |
|----------|-------------------------------------------------------------------------------------------------------------------------------|
| Контракт Bridge | Контракт Bridge, который управляет запросами, голосами, исполнениями, должен быть развернут в каждой цепочке. Пользователи вызывают `deposit`в Bridge, чтобы запустить трансфер, и Bridge делегирует процесс контракту Handler, соответствующему контракту Target. Как только контракт Handler успешно вызовет контракт Target, контракт Bridge эмитирует событие `Deposit` для уведомления ретрансляторов. |
| Контракт Handler | Контракт взаимодействует с контрактом Target для выполнения депозита или предложения. Он проверяет запрос пользователя, вызывает контракт Target и помогает с некоторыми настройками контракта Target. Существуют определенные контракты Handler для вызова каждого контракта Target, который имеет другой интерфейс. Косвенные вызовы, которые производит контракт Handler, позволяют мосту осуществлять передачу любых активов. В настоящее время в рамках ChainBridge реализовано три типа контрактов Handler: ERC20Handler, ERC721Handler и GenericHandler. |
| Контракт Target | Контракт, который управляет активами, подлежащими обмену, или сообщениями, передающимися между цепочками. Взаимодействие с этим контрактом будет осуществляться с каждой стороны моста. |

<div style={{textAlign: 'center'}}>

![Архитектура ChainBridge](/img/edge/chainbridge/architecture.svg) *Архитектура ChainBridge*

</div>

<div style={{textAlign: 'center'}}>

![Рабочий процесс трансфера токенов ERC20](/img/edge/chainbridge/erc20-workflow.svg) *ex. Рабочий процесс трансфера токенов ERC20*

</div>

## Типы аккаунтов {#types-of-accounts}

Перед началом работы убедитесь, что на аккаунтах достаточно нативных токенов для создания транзакций. В Polygon Edge вы можете назначить предварительно созданные балансы на аккаунты при создании генезисного блока.

| **Тип** | **Описание** |
|----------|-------------------------------------------------------------------------------------------------------------------------------|
| Администратор | По умолчанию данному аккаунту будет присвоена роль администратора. |
| Пользователь | Аккаунт отправителя/получателя, который отправляет/получает активы. Аккаунт отправителя оплачивает комиссию за газ при утверждении трансфера токенов и вызове депозита в контракте Bridge для начала трансфера. |

:::info Роль администратора
Некоторые действия может выполнить только аккаунт администратора. Тот, кто развертывает контракт Bridge, имеет по умолчанию роль администратора. Ниже вы найдете инструкции, как предоставить роль администратора другому аккаунту и удалить эту роль.

### Добавление роли администратора {#add-admin-role}

Добавление администратора

```bash
# Grant admin role
$ cb-sol-cli admin add-admin \
  --url [JSON_RPC_URL] \
  --privateKey [PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --admin "[NEW_ACCOUNT_ADDRESS]"
```
### Удаление роли администратора {#revoke-admin-role}

Удаление администратора

```bash
# Revoke admin role
$ cb-sol-cli admin remove-admin \
  --url [JSON_RPC_URL] \
  --privateKey [PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --admin "[NEW_ACCOUNT_ADDRESS]"
```

## Операции, которые разрешено осуществлять в рамках аккаунта `admin`, приведены ниже. {#account-are-as-below}

### Настройка ресурса {#set-resource}

Регистрация идентификатора ресурса с адресом контракта для обработчика.

```bash
# Register new resource
$ cb-sol-cli bridge register-resource \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --resourceId "[RESOURCE_ID]" \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --handler "[HANDLER_CONTRACT_ADDRESS]" \
  --targetContract "[TARGET_CONTRACT_ADDRESS]"
```

### Настройка контракта с возможностью произвольного сжигания/минтинга {#make-contract-burnable-mintable}

Настройка контракта на токены с возможностью произвольного минтинга/сжигания в обработчике.

```bash
# Let contract burnable/mintable
$ cb-sol-cli bridge set-burn \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --handler "[HANDLER_CONTRACT_ADDRESS]" \
  --tokenContract "[TARGET_CONTRACT_ADDRESS]"
```

### Отмена предложения {#cancel-proposal}

Отмена предложения по исполнению.

```bash
# Cancel ongoing proposal
$ cb-sol-cli bridge cancel-proposal \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --resourceId "[RESOURCE_ID]" \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --chainId "[CHAIN_ID_OF_SOURCE_CHAIN]" \
  --depositNonce "[NONCE]"
```

### Пауза / снятие паузы {#pause-unpause}

Постановка на временную паузу депозитов, создания предложений, голосования и исполнения депозитов.

```bash
# Pause
$ cb-sol-cli admin pause \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]"

# Unpause
$ cb-sol-cli admin unpause \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]"
```

### Изменение комиссии {#change-fee}

Изменение комиссии, которая будет выплачена в адрес контракта Bridgeю

```bash
# Change fee for execution
$ cb-sol-cli admin set-fee \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --fee [FEE_IN_WEI]
```

### Добавление/удаление ретранслятора {#add-remove-a-relayer}

Добавление аккаунта в качестве нового ретранслятора или удаление аккаунта из ретрансляторов.

```bash
# Add relayer
$ cb-sol-cli admin add-relayer \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --relayer "[NEW_RELAYER_ADDRESS]"

# Remove relayer
$ cb-sol-cli admin remove-relayer \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --relayer "[RELAYER_ADDRESS]"
```

### Изменение порога ретранслятора {#change-relayer-threshold}

Изменение количества голосов, требуемых для исполнение предложения.

```bash
# Remove relayer
$ cb-sol-cli admin set-threshold \
  --url [JSON_RPC_URL] \
  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \
  --bridge "[BRIDGE_CONTRACT_ADDRESS]" \
  --threshold [THRESHOLD]
```
:::

## Идентификатор цепочки {#chain-id}

Chainbridge  `chainId`— это произвольное значение, которое используется в мосте для дифференциации между сетями блокчейн, и оно должно находиться в диапазоне uint8. Чтобы избежать путаницы с идентификатором цепочки, эти значения не совпадают. Данное значение должно быть уникальным, но оно не должно совпадать с идентификатором сети.

В этом примере мы задали `99`в  `chainId`, потому что идентификатор цепочки тестовой сети Mumbai testnet составляет `80001`, который не может быть представлен при помощи uint8.

## Идентификатор ресурса {#resource-id}

Идентификатор ресурса — это уникальное 32-байтое значение в межсетевой среде, связанное с определенным активом (ресурсом), который передается между сетями.

Идентификатор ресурса — это произвольное число, но, как правило, последний байт содержит идентификатор цепочки исходной цепочки (сети, из которой был получен актив).

## JSON-RPC URL для Polygon PoS {#json-rpc-url-for-polygon-pos}

В данном руководстве мы будем использовать https://rpc-mumbai.matic.today, публичный URL-адрес JSON-RPC , предоставленный Polygon, который может иметь ограничения по трафику или скорости. Он будет использоваться только для подключения к тестовой сети Polygon Mumbai. Рекомендуем получить URL-адрес JSON-RPC с помощью внешнего сервиса, например Infura, поскольку развертывание контрактов требует отправления множества запросов/заявок в адрес JSON-RPC.

## Способы обработки трансфера токенов  {#ways-of-processing-the-transfer-of-tokens}
При осуществлении трансфера токенов ERC20 между цепочками они могут обрабатываться в двух различных режимах:

### Режим блокировки/освобождения {#lock-release-mode}
<b>Исходная цепочка: </b>токены, которые вы отправляете, будут заблокированы в контракте Handler. <br/><b>Конечная цепочка:</b> то же количество токенов, которые вы отправили в исходной цепочке, будет разблокировано и передано из контракта Handler на аккаунт получателя в конечной цепочке.

### Режим сжигания/минтинга {#burn-mint-mode}
<b>Исходная цепочка:</b> токены, которые вы отправляете, будут токенами для <br/>сжигания. <b>Конечная цепочка:</b> то же количество токенов, которые вы отправили и сожгли в исходной цепочке, будет подвержено минтингу в конечной цепочке и отправлено на аккаунт получателя.

Вы можете использовать различные режимы в каждой цепочке. Это означает, что вы можете заблокировать токен в основной цепочке в то время, пока осуществляется минтинг токена в подцепочке для осуществления трансфера. Например, блокировка/освобождение токенов может иметь смысл, если контролируется общий объем или график минтинга. Токены будут подвергаться минтингу/сжиганию, если контракт в подцепочке должен следовать за поставкой в основой цепочке.

Режим по умолчанию — это режим блокировки/освобождения. Если вы хотите сделать токены с возможностью минтинга/сжигания, вам нужно вызвать метод `adminSetBurnable`. Если вы хотите осуществлять минтинг токенов при исполнении, вам нужно будет предоставить роль `minter` контракту Handler ERC20.


