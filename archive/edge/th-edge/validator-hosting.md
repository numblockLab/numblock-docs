---
id: validator-hosting
title: การโฮสต์ตัวตรวจสอบความถูกต้อง
description: "ข้อกำหนดเกี่ยวกับการโฮสต์สำหรับ Polygon Edge"
keywords:
- docs
- polygon
- edge
- hosting
- cloud
- setup
- validator
---

ด้านล่างเป็นคำแนะนำเกี่ยวกับการโฮสต์โหนดตัวตรวจสอบความถูกต้องในเครือข่าย Polygon Edge อย่างถูกต้องโปรดให้ความสำคัญกับรายการทั้งหมดที่ระบุไว้ด้านล่าง เพื่อคุณสามารถมั่นใจ
ว่ามีการกำหนดค่าตัวตรวจสอบความถูกต้องของคุณอย่างถูกต้อง เพื่อให้ทำงานได้อย่างปลอดภัย เสถียร และมีประสิทธิภาพ

## พื้นฐานความรู้ {#knowledge-base}

ก่อนคุณลองเรียกใช้โหนดตัวตรวจสอบความถูกต้อง โปรดอ่านเอกสารนี้อย่างละเอียด    
เอกสารเพิ่มเติมที่อาจเป็นประโยชน์คือ:

- [การติดตั้ง](get-started/installation)
- [การตั้งค่าในระบบคลาวด์](get-started/set-up-ibft-on-the-cloud)
- [คำสั่ง CLI](get-started/cli-commands)
- [ไฟล์กำหนดค่าของเซิร์ฟเวอร์](configuration/sample-config)
- [คีย์ส่วนตัว](configuration/manage-private-keys)
- [เมตริก Prometheus](configuration/prometheus-metrics)
- [ตัวจัดการข้อมูลลับ](/docs/category/secret-managers)
- [สำรอง/กู้คืนข้อมูล](working-with-node/backup-restore)

## ข้อกำหนดของระบบขั้นต่ำ {#minimum-system-requirements}

| ประเภท | ค่า | กำหนดตาม |
|------|------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------|
| CPU | 2 คอร์ | <ul><li>จำนวนการสืบค้น JSON-RPC</li><li>ขนาดของสถานะบล็อกเชน</li><li>ขีดจำกัดค่าแก๊สต่อบล็อก</li><li>เวลาในการสร้างบล็อก</li></ul> |
| RAM | 2 GB | <ul><li>จำนวนการสืบค้น JSON-RPC</li><li>ขนาดของสถานะบล็อกเชน</li><li>ขีดจำกัดค่าแก๊สต่อบล็อก</li></ul> |
| ดิสก์ | <ul><li>พาร์ติชั่นรูทขนาด 10 GB</li><li>พาร์ติชั่นรูทขนาด 30 GB โดยใช้ LVM ในการขยายดิสก์</li></ul> | <ul><li>ขนาดของสถานะบล็อกเชน</li></ul> |


## การกำหนดค่าบริการ {#service-configuration}

คุณจำเป็นต้องเรียกใช้ไบนารี `polygon-edge` เป็นบริการของระบบโดยอัตโนมัติ เมื่อทำการเชื่อมต่อเครือข่าย และมีฟังก์ชันเริ่ม / หยุด / รีสตาร์ทเราแนะนำให้ใช้ตัวจัดการบริการ เช่น `systemd.`

ตัวอย่าง ไฟล์กำหนดค่าระบบ `systemd`:
```
[Unit]
Description=Polygon Edge Server
After=network.target
StartLimitIntervalSec=0

[Service]
Type=simple
Restart=always
RestartSec=10
User=ubuntu
ExecStart=/usr/local/bin/polygon-edge server --config /home/ubuntu/polygon/config.yaml

[Install]
WantedBy=multi-user.target
```

### ไบนารี {#binary}

ในเวิร์กโหลดด้านการใช้งานจริง ควรปรับใช้ไบนารี `polygon-edge` จากไบนารีของรุ่น GitHub ที่สร้างไว้ล่วงหน้า ไม่ใช่การคอมไพล์ไบนารีด้วยตนเอง
:::info

เมื่อคอมไพล์สาขา GitHub `develop` ด้วยตนเอง คุณอาจนำการเปลี่ยนแปลงที่ส่งผลกระทบเข้ามาในสภาพแวดล้อมของคุณได้   
ด้วยเหตุนี้ เราจึงแนะนำให้ปรับใช้ไบนารีของ Polygon Edge เฉพาะจากรุ่นต่างๆ เพราะว่าจะมี
ข้อมูลเกี่ยวกับการเปลี่ยนแปลงที่ส่งผลกระทบและวิธีการแก้ไขปัญหานั้น

:::

โปรดดูภาพรวมของวิธีการติดตั้งอย่างละเอียดได้ใน[การติดตั้ง](/docs/edge/get-started/installation)

### การจัดเก็บข้อมูล {#data-storage}

คุณต้องติดตั้งโฟลเดอร์ `data/` ที่ปรากฏสถานะบล็อกเชนทั้งหมดลงในดิสก์ / ไดรฟ์ข้อมูลเฉพาะ ซึ่งทำให้ดำเนิน
การสำรองข้อมูลดิสก์โดยอัตโนมัติ การเพิ่มไดรฟ์ข้อมูล และ (ไม่บังคับ) การติดตั้งดิสก์ไดรฟ์ข้อมูลกับอินสแตนซ์อื่น ในกรณีเกิดเหตุขัดข้อง


### ไฟล์บันทึก {#log-files}

คุณต้องสับเปลี่ยนไฟล์บันทึกเป็นแบบรายวัน (โดยใช้เครื่องมือ เช่น `logrotate`)
:::warning

หากมีการกำหนดค่าโดยไม่มีการสับเปลี่ยนบันทึก ไฟล์บันทึกอาจจะใช้พื้นที่ดิสก์ที่มีอยู่ทั้งหมด ซึ่งอาจส่งผลกระทบต่อช่วงเวลาการดำเนินงานของตัวตรวจสอบความถูกต้อง

:::

ตัวอย่าง การกำหนค่า `logrotate`:
```
/home/ubuntu/polygon/logs/node.log
{
        rotate 7
        daily
        missingok
        notifempty
        compress
        prerotate
                /usr/bin/systemctl stop polygon-edge.service
        endscript
        postrotate
                /usr/bin/systemctl start polygon-edge.service
        endscript
}
```


ดูคำแนะนำเกี่ยวกับการจัดเก็บบันทึกได้ที่ส่วน[การทำบันทึก](#logging)ด้านล่าง

### รูปแบบการขึ้นต่อกันเพิ่มเติม {#additional-dependencies}

`polygon-edge` ได้รับการคอมไพล์แบบคงที่ โดยไม่ต้องมีรูปแบบการขึ้นต่อกันของระบบปฏิบัติการที่โฮสต์เพิ่มเติม

## การบำรุงรักษา {#maintenance}

ด้านล่างนี้เป็นหลักปฏิบัติที่ดีที่สุดซึ่งใช้ในการบำรุงรักษาโหนดตัวตรวจสอบความถูกต้องที่อยู่ในระหว่างการเรียกใช้งานในเครือข่าย Polygon Edge

### การสำรองข้อมูล {#backup}

วิธีการสำรองข้อมูลที่แนะนำใช้กับโหนดของ Polygon Edge มีสองแบบ

หากทำได้ เราขอแนะนำให้คุณใช้ทั้งสองวิธีการนั้นกับการสำรองข้อมูลใน Polygon Edge ซึ่งเป็นตัวเลือกที่ใช้งานได้อยู่เสมอ

* ***การสำรองข้อมูลไดรฟ์ข้อมูล***:    
  การสำรองข้อมูลที่เพิ่มขึ้นทุกวันในไดรฟ์ข้อมูล `data/` ของโหนด Polygon Edge หรือการสำรองข้อมูลทั้งหมดใน VM หากสามารถทำเช่นนั้นได้


* ***การสำรองข้อมูลใน Polygon Edge***:      แนะนำงาน CRON รายวัน ซึ่งสำรองข้อมูลของ Polygon Edge เป็นประจำ และย้ายไฟล์ `.dat` ไปพื้นที่ภายนอกหรือไปยังที่เก็บข้อมูลอ็อบเจ็กต์ในคลาวด์ที่ปลอดภัย

ในทางที่ดีที่สุด การสำรองข้อมูลของ Polygon Edge ต้องไม่ทับซ้อนกับการสำรองข้อมูลในไดรฟ์ข้อมูลซึ่งระบุไว้ด้านบน

ดูคำแนะนำเกี่ยวกับวิธีการสำรองข้อมูลของ Polygon Edge ได้ที่[การสำรอง/กู้คืนข้อมูลอินสแตนซ์ของโหนด](working-with-node/backup-restore)

### การทำบันทึก {#logging}

ในบันทึกต่างๆ ที่โหนด Polygon Edge แสดงข้อมูลควร:
- ได้รับการส่งไปยังพื้นที่จัดเก็บข้อมูลภายในที่มีความสามารถในการจัดทำดัชนีและการค้นหา
- มีระยะเวลาเก็บรักษาบันทึก 30 วัน

หากคุณตั้งค่าตัวตรวจสอบความถูกต้องของ Polygon Edge ครั้งนี้เป็นครั้งแรก เราแนะนำให้เริ่มโหนด
พร้อมกับตัวเลือก `--log-level=DEBUG` เพื่อให้สามารถดีบักปัญหาต่างๆ ที่คุณอาจพบได้อย่างรวดเร็ว

:::info

 `--log-level=DEBUG` จะสร้างเอาต์พุตบันทึกของโหนดมีความละเอียดที่สุดเท่าที่ทำได้   
บันทึกเกี่ยวกับดีบักจะเพิ่มขนาดของไฟล์บันทึกขึ้นเป็นอย่างมาก ซึ่งต้องพิจารณาถึงเมื่อตั้งค่าโซลูชันเกี่ยวกับการสับเปลี่ยนบันทึก

:::
### แพทช์ความปลอดภัยของระบบปฏิบัติการ {#os-security-patches}

ผู้ดูแลต้องตรวจสอบให้แน่ใจว่ามีการอัปเดตระบบปฏิบัติการของอินสแตนซ์ตัวตรวจสอบความถูกต้องอย่างสม่ำเสมอโดยใช้แพทช์ล่าสุด และให้ดำเนินการเช่นนั้นอย่างน้อยหนึ่งครั้งต่อเดือน

## เมตริก {#metrics}

### เมตริกของระบบ {#system-metrics}

ผู้ดูแลต้องตั้งค่าวิธีการติดตามเมตริกบางส่วนของระบบ (เช่น Telegraf + InfluxDB + Grafana หรือ SaaS ของบุคคลภายนอก)

เมตริกที่ต้องอยู่ภายใต้การติดตามและต้องมีการตั้งค่าการแจ้งเตือนสัญญาณอันตราย:

| ชื่อเมตริก | ค่าเกณฑ์การแจ้งเตือน |
|-----------------------|-------------------------------|
| การใช้ CPU (%) | มากกว่า 90% เป็นเวลานานกว่า 5 นาที |
| การใช้ RAM (%) | มากกว่า 90% เป็นเวลานานกว่า 5 นาที |
| การใช้รูทดิสก์ | มากกว่า 90% |
| การใช้ดิสก์ข้อมูล | มากกว่า 90% |

### เมตริกของตัวตรวจสอบความถูกต้อง {#validator-metrics}

ผู้ดูแลต้องกำหนดค่าชุดเมตริกจาก Prometheus API ของ Polygon Edge เพื่อให้สามารถ
ติดตามการดำเนินการของบล็อกเชน

โปรดดู[เมตริก Prometheus](configuration/prometheus-metrics) เพื่อทำความเข้าใจว่ามีการแสดงเมตริกใดบ้าง ตลอดจนวิธีการกำหนดค่าชุด เมตริก Prometheus


คุณต้องให้ความสำคัญเป็นพิเศษกับบรรดาเมตริกดังต่อไปนี้:
- ***เวลาในการสร้างบล็อก*** - หากเวลาในการสร้างบล็อกนานกว่าปกติ อาจมีปัญหาเกิดขึ้นกับเครือข่าย
- ***จำนวนรอบฉันทามติ*** - หากมีมากกว่า 1 รอบ อาจมีปัญหาเกี่ยวกับชุดตัวตรวจสอบความถูกต้องในเครือข่าย
- ***จำนวนเพียร์*** - หากจำนวนเพียร์ลดลง แสดงว่ามีปัญหาเกี่ยวกับการเชื่อมต่อในระบบ

## การรักษาความปลอดภัย {#security}

ด้านล่างนี้เป็นหลักปฏิบัติที่ดีที่สุดซึ่งใช้ในการรักษาความปลอดภัยของโหนดตัวตรวจสอบความถูกต้องที่อยู่ในระหว่างการเรียกใช้งานในเครือข่าย Polygon Edge

### บริการ API {#api-services}

- ***JSON-RPC*** -
มีแต่บริการ API ที่ต้องแสดงต่อสาธารณะ (ผ่าน Load Balancer หรือโดยตรง)    
ให้เรียกใช้ API นี้กับอินเทอร์เฟซทั้งหมดหรือกับที่อยู่ IP เฉพาะ ( ตัวอย่าง: `--json-rpc 0.0.0.0:8545` หรือ `--json-prc 192.168.1.1:8545`  )
:::info
เนื่องจากเป็น API ที่แสดงต่อสาธารณะ เราแนะนำให้คุณมี Load Balancer / Reverse Proxy อยู่เบื้องหน้าเพื่อสร้างความปลอดภัยและจำกัดอัตรา

:::


- ***LibP2P*** -
นี่เป็น API ระบบเครือข่ายที่โหนดใช้ในการสื่อสารกับเพียร์ต้องเรียกใช้กับอินเทอร์เฟซทั้งหมดหรือกับที่อยู่ IP เฉพาะ
( `--libp2p 0.0.0.0:1478` หรือ `--libp2p 192.168.1.1:1478` )ไม่ควรแสดง API นี้ต่อสาธารณะ
แต่โหนดอื่นทั้งหมดต้องสามารถเข้าถึง API นั้นได้
:::info

หากมีการใช้กับ localhost ( `--libp2p 127.0.0.1:1478` ) โหนดอื่นๆ จะไม่สามารถเชื่อมต่อได้

:::


- ***GRPC*** -
ใช้ API นี้เฉพาะสำหรับการเรียกใช้คำสั่งของตัวดำเนินการเท่านั้นดังนั้น ให้เรียกใช้ API นั้นกับ localhost เท่านั้น ( `--grpc-address 127.0.0.1:9632` )

### ข้อมูลลับของ Polygon Edge {#polygon-edge-secrets}

ไม่ควรเก็บข้อมูลลับของ Polygon Edge (คีย์ `ibft` และ `libp2p` ) ไว้ในระบบไฟล์ของเครื่อง   
ควรใช้[ตัวจัดการข้อมูลลับ](configuration/secret-managers/set-up-aws-ssm)ที่ระบบรองรับแทน    
ควรใช้การจัดเก็บข้อมูลลับในระบบไฟล์ภายในเฉพาะในสภาพแวดล้อมที่ไม่มีส่วนได้เสียกับการใช้งานจริง

## อัปเดต {#update}

ต่อไปนี้ คือวิธีการอัปเดตที่ต้องการสำหรับโหนดตัวตรวจสอบความถูกต้อง ตามที่ระบุไว้ในคำแนะนำทีละขั้นตอน

### กระบวนการอัปเดต {#update-procedure}

- ให้ดาวน์โหลดไบนารี Polygon Edge ล่าสุดจาก GitHub อย่างเป็นทางการ[รุ่นต่างๆ](https://github.com/0xPolygon/polygon-edge/releases)
- ให้หยุดบริการ Polygon Edge ( ตัวอย่าง: `sudo systemctl stop polygon-edge.service` )
- ให้แทนที่ไบนารี `polygon-edge` ที่มีอยู่ด้วยไบนารีที่ดาวน์โหลดมา ( ตัวอย่าง: `sudo mv polygon-edge /usr/local/bin/` )
- โปรดตรวจสอบว่าคุณใช้เวอร์ชัน `polygon-edge` ที่ถูกต้อง โดยการเรียกใช้ `polygon-edge version` - ต้องสอดคล้องกับเวอร์ชันที่เผยแพร่
- ก่อนเริ่มใช้งานบริการ `polygon-edge` ตรวจสอบเอกสารประกอบการเผยแพร่ว่า จำเป็นต้องมีการดำเนินขั้นเกี่ยวกับความเข้ากันได้แบบย้อนหลังหรือไม่
- เริ่มบริการ `polygon-edge` ( ตัวอย่าง: `sudo systemctl start polygon-edge.service` )
- สุดท้าย โปรดตรวจสอบเอาต์พุตบันทึก `polygon-edge` และทำให้มั่นใจว่า ทุกสิ่งทุกอย่างสามารถเรียกใช้ได้โดยไม่มีบันทึก `[ERROR]`

:::warning

เมื่อมีรุ่นที่ส่งผลกระทบ ให้ใช้กระบวนการอัปเดตนี้กับโหนดทั้งหมด เนื่องจาก
ไบนารีที่กำลังใช้งานอยู่จะไม่สามารถเข้ากันได้กับรุ่นใหม่

หมายความว่า ต้องหยุดการทำงานของเชนเป็นระยะเวลาสั้นๆ ( จนกว่าจะมีการแทนที่ไบนารี `polygon-edge` และรีสตาร์ทบริการ )
ดังนั้น คุณต้องวางแผนให้สอดคล้องกัน

คุณสามารถใช้เครื่องมือต่างๆ เช่น **[Ansible](https://www.ansible.com/)** หรือสคริปต์ที่กำหนดเองบางอย่างเพื่อทำการอัปเดตอย่างมีประสิทธิภาพ
และลดลงช่วงเวลาที่เชนไม่ทำงาน

:::

## กระบวนการเริ่มต้นระบบ {#startup-procedure}

ต่อไปนี้เป็นขั้นตอนที่ต้องการสำหรับกระบวนการเริ่มต้นสำหรับตัวตรวจสอบความถูกต้อง Polygon Edge

- อ่านเอกสารที่ระบุไว้ในส่วน[พื้นฐานความรู้](#knowledge-base)
- แพทช์ระบบปฏิบัติการล่าสุดกับโหนดตัวตรวจสอบความถูกต้อง
- ดาวน์โหลดไบนารี `polygon-edge` ล่าสุดจาก GitHub อย่างเป็นทางการ[รุ่นต่างๆ](https://github.com/0xPolygon/polygon-edge/releases) และวางไว้ในอินสแตนซ์ภายใน `PATH`
- เริ่มใช้งาน[ตัวจัดการข้อมูลลับ](/docs/category/secret-managers)ที่ระบบรองรับ โดยใช้คำสั่ง CLI `polygon-edge secrets generate`
- สร้างและเก็บข้อมูลลับโดยใช้ [คำสั่ง CLI](/docs/edge/get-started/cli-commands#secrets-init-flags) `polygon-edge secrets init`
- จดบันทึกค่า `NodeID` และ `Public key (address)`
- สร้างไฟล์ `genesis.json` ตามที่ระบุไว้ใน[การตั้งค่าคลาวด์](get-started/set-up-ibft-on-the-cloud#step-3-generate-the-genesis-file-with-the-4-nodes-as-validators) โดยใช้ [คำสั่ง CLI](/docs/edge/get-started/cli-commands#genesis-flags) `polygon-edge genesis`
- สร้างไฟล์การกำหนดค่าเริ่มต้นโดยใช้ [คำสั่ง CLI](/docs/edge/configuration/sample-config) `polygon-edge server export`
- แก้ไขไฟล์ `default-config.yaml` เพื่อจัดลงในสภาพแวดล้อมโหนดตัวตรวจสอบความถูกต้องภายใน ( เช่น พาธไฟล์ เป็นต้น )
- สร้างบริการ Polygon Edge ( `systemd` หรือคล้ายกัน ) โดยไบนารี `polygon-edge` จะเรียกใช้งานเซิร์ฟเวอร์จากไฟล์ `default-config.yaml`
- เริ่มเซิร์ฟเวอร์ Polygon Edge โดยเริ่มใช้งานบริการ ( ตัวอย่าง: `systemctl start polygon-edge` )
- โปรดตรวจสอบเอาต์พุตบันทึก `polygon-edge` และทำให้มั่นใจว่ากำลังมีการสร้างบล็อกและไม่ปรากฏบันทึก `[ERROR]`
- โปรดตรวจสอบการใช้งานของเชนโดยการเรียกใช้เมธอด JSON-RPC เช่น [`eth_chainId`](/docs/edge/api/json-rpc-eth#eth_chainid)
