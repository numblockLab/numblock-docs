---
id: set-up-gcp-secrets-manager
title: ตั้งค่าตัวจัดการข้อมูลลับ GCP
description: "ตั้งค่าตัวจัดการข้อมูลลับ GCP ให้กับ Polygon Edge"
keywords:
  - docs
  - polygon
  - edge
  - gcp
  - secrets
  - manager
---

## ภาพรวม {#overview}

ปัจจุบันนี้ Polygon Edge มีความเชื่อมโยงกับการเก็บรักษาข้อมูลลับเกี่ยวกับรันไทม์ที่สำคัญอยู่ 2 ส่วน:
*  **คีย์ส่วนตัวของตัวตรวจสอบความถูกต้อง**ที่โหนดใช้งาน หากโหนดนั้นเป็นตัวตรวจสอบความถูกต้อง
*  **คีย์ส่วนตัวสำหรับการดำเนินการในเครือข่าย**ที่ libp2p ใช้งาน เพื่อเข้าร่วมและสื่อสารกับเพียร์อื่นๆ

โปรดอ่านข้อมูลเพิ่มเติมที่คู่มือเกี่ยวกับ[การจัดการคีย์ส่วนตัว](/docs/edge/configuration/manage-private-keys)

บรรดาโมดูลของ Polygon Edge **ไม่จำเป็นต้องรู้ถึงวิธีการเก็บรักษาข้อมูลลับ**และในท้ายที่สุด โมดูลไม่จำเป็นต้องสนใจว่ามีการเก็บข้อมูลลับไว้ในเซิร์ฟเวอร์ที่ตั้งอยู่ไกลออกไปหรือภายในดิสก์ของโหนด

สิ่งเดียวที่โมดูลต้องทราบเกี่ยวกับการเก็บข้อมูลลับก็คือ **ความรู้เกี่ยวกับการใช้ข้อมูลลับ** กล่าวคือ **ทราบว่าข้อมูลลับใดที่ต้องรับหรือบันทึก**รายละเอียดเกี่ยวกับการนำไปใช้อย่างละเอียดกับการดำเนินการเหล่านี้ต้องได้รับการ Delegate ไปยัง `SecretsManager` ซึ่งแน่นอนว่าคือ Abstraction

ตอนนี้ตัวดำเนินการโหนดที่เริ่มใช้ Polygon Edge สามารถระบุตัวจัดการข้อมูลลับที่ต้องการและเมื่อ
มีการสร้างอินสแตนซ์ของตัวจัดการข้อมูลลับที่ถูกต้อง โมดูลต่างๆ สามารถดำเนินการกับข้อมูลลับนั้นผ่านอินเทอร์เฟซที่กล่าวถึงโดยไม่ใส่ใจว่า มีการเก็บข้อมูลลับไว้ในดิสก์หรือเซิร์ฟเวอร์

บทความนี้ให้รายละเอียดขั้นตอนที่จำเป็นในการศึกษาเกี่ยวกับ Polygon Edge และใช้งานกับ[ตัวจัดการข้อมูลลับ GCP](https://cloud.google.com/secret-manager)

:::info คู่มือก่อนหน้านี้
ก่อนอ่านบทความนี้ เรา**ขอแนะนำ**ให้คุณอ่านบทความต่างๆ ใน[**การตั้งค่าภายใน**](/docs/edge/get-started/set-up-ibft-locally)ตลอดจนบทความ[**การตั้งค่าในระบบคลาวด์**](/docs/edge/get-started/set-up-ibft-on-the-cloud)
:::


## ข้อกำหนดเบื้องต้น {#prerequisites}
### บัญชีรับวางบิล GCP {#gcp-billing-account}
เพื่อใช้ตัวจัดการข้อมูลลับ GCP ผู้ใช้จำเป็นต้องมี[บัญชีรับวางบิล](https://console.cloud.google.com/)ที่เปิดใช้งานอยู่ในพอร์ทัล GCP
มีการจัดเตรียมบัญชี Google ใหม่ในแพลตฟอร์ม GCP ให้มาพร้อมกับเงินทุนซึ่งสามารถใช้ได้ในขณะเริ่มต้น เพื่อเป็นการทดลองใช้งานฟรีรูปแบบหนึ่ง
ข้อมูลเพิ่มเติม [เอกสาร GCP](https://cloud.google.com/free)

### API ตัวจัดการข้อมูลลับ {#secrets-manager-api}
ผู้ใช้จะต้องเปิดใช้งาน API ตัวจัดการข้อมูลลับ GCP ก่อนจึงจะสามารถใช้งานได้
โดยสามารถดำเนินการได้ผ่าน[พอร์ทัล API ตัวจัดการข้อมูลลับ](https://console.cloud.google.com/apis/library/secretmanager.googleapis.com)
ข้อมูลเพิ่มเติม: [การกำหนดค่าตัวจัดการข้อมูลลับ](https://cloud.google.com/secret-manager/docs/configuring-secret-manager)

### ข้อมูลส่วนบุคคล GCP {#gcp-credentials}
ในขั้นตอนสุดท้าย ผู้ใช้จำเป็นต้องสร้างข้อมูลส่วนบุคคลใหม่ที่จะนำมาใช้ในการรับรองความถูกต้อง
ซึ่งสามารถทำได้โดยดำเนินการตามคำแนะนำที่ระบุไว้[ที่นี่](https://cloud.google.com/secret-manager/docs/reference/libraries)    คุณต้องส่งไฟล์ json ที่สร้างขึ้น ซึ่งประกอบด้วยข้อมูลส่วนบุคคล ไปยังโหนดแต่ละโหนดที่ต้องใช้ตัวจัดการข้อมูลลับ GCP

ข้อมูลที่จำเป็นต้องมีก่อนดำเนินการต่อไป มีดังต่อไปนี้:
* **ID โครงการ** (ID โครงการที่นิยามไว้ในแพลตฟอร์ม GCP)
* **ตำแหน่งไฟล์ข้อมูลส่วนบุคคล** (พาธไปยังไฟล์ json ซึ่งประกอบข้อมูลส่วนบุคคลนั้น)

## ขั้นตอนที่ 1 - สร้างค่ากำหนดของตัวจัดการข้อมูลลับ {#step-1-generate-the-secrets-manager-configuration}

เพื่อให้ Polygon Edge สามารถสื่อสารกับ GCP SM ได้อย่างราบรื่นไม่มีสะดุด จำเป็นต้องแยกวิเคราะห์
ไฟล์กำหนดค่าที่สร้างมาแล้ว ที่ประกอบข้อมูลที่จำเป็นทั้งหมดสำหรับพื้นที่จัดเก็บข้อมูลลับใน GCP SM

เพื่อสร้างค่ากำหนดนั้น ให้เรียกใช้คำสั่งดังต่อไปนี้:

```bash
polygon-edge secrets generate --type gcp-ssm --dir <PATH> --name <NODE_NAME> --extra project-id=<PROJECT_ID>,gcp-ssm-cred=<GCP_CREDS_FILE>
```

พารามิเตอร์แสดงถึง:
* `PATH` เป็นพาธซึ่งเป็นปลายทางในการส่งออกไฟล์กำหนดค่า`./secretsManagerConfig.json` ที่เป็นค่าเริ่มต้น
* `NODE_NAME` คือชื่อของโหนดปัจจุบันที่มีการตั้งค่าการกำหนดค่า GCP SM ให้ซึ่งสามารถมีค่าแบบกำหนดเอง`polygon-edge-node` ที่เป็นค่าเริ่มต้น
* `PROJECT_ID` เป็น ID ของโครงการซึ่งผู้ใช้ได้กำหนดไว้ในคอนโซล GCP ในขณะกำหนดค่าบัญชีและการเริ่มใช้งาน API ตัวจัดการข้อมูลลับ
* `GCP_CREDS_FILE`เป็นพาธไปยังไฟล์ json ซึ่งมีข้อมูลส่วนบุคคลที่จะอนุญาตให้อ่าน/เขียนสิทธิ์การเข้าใช้งานตัวจัดการข้อมูลลับ

:::caution ชื่อโหนด

โปรดระวังเมื่อระบุชื่อโหนด

Polygon Edge ใช้ชื่อโหนดเฉพาะเพื่อติดตามข้อมูลลับซึ่งโหนดสร้างและใช้ใน GCP SM
การระบุชื่อโหนดที่มีอยู่อาจส่งผลทำให้การเขียนข้อมูลลับไปยัง GCP SM ล้มเหลว

เก็บข้อมูลลับไว้ในพาธหลักนี้: `projects/PROJECT_ID/NODE_NAME`
:::

## ขั้นตอนที่ 2 - เริ่มใช้คีย์ลับโดยใช้ค่ากำหนด {#step-2-initialize-secret-keys-using-the-configuration}

ตอนนี้ เมื่อเรามีไฟล์กำหนดค่าแล้ว เราสามารถเริ่มใช้คีย์ลับที่จำเป็นกับไฟล์กำหนดค่าที่ตั้งค่าไว้ในขั้นตอนที่ 1 โดยใช้ `--config`:

```bash
polygon-edge secrets init --config <PATH>
```

พารามิเตอร์ `PATH` เป็นที่ตั้งของพารามิเตอร์ตัวจัดการข้อมูลลับที่สร้างขึ้นก่อนหน้านี้ในขั้นตอนที่ 1

## ขั้นตอนที่ 3 - สร้างไฟล์ Genesis {#step-3-generate-the-genesis-file}

ควรสร้างไฟล์ Genesis ในลักษณะเดียวกันกับคู่มือ[**การตั้งค่าภายใน**](/docs/edge/get-started/set-up-ibft-locally)และ[**การตั้งค่าในระบบคลาวด์**](/docs/edge/get-started/set-up-ibft-on-the-cloud) พร้อมกับการแก้ไขเพิ่มเติมเล็กน้อย

เนื่องจากมีการใช้ GCP SM แทนระบบไฟล์ภายใน จึงควรเพิ่มที่อยู่ของตัวตรวจสอบความถูกต้องผ่านค่าสถานะ `--ibft-validator`:
```bash
polygon-edge genesis --ibft-validator <VALIDATOR_ADDRESS> ...
```

## ขั้นตอนที่ 4 - เริ่มใช้ไคลเอ็นต์ของ Polygon Edge {#step-4-start-the-polygon-edge-client}

ตอนนี้ เมื่อมีการกำหนดคีย์และสร้างไฟล์ Genesis แล้ว ขั้นตอนสุดท้ายของกระบวนการนี้คือ การเริ่มต้นPolygon Edge โดยใช้คำสั่ง `server`

ใช้คำสั่ง`server`  ในลักษณะเดียวกันกับที่ได้ระบุไว้ในคู่มือที่กล่าวถึงก่อนหน้านี้ โดยมีการเพิ่มเติมเล็กน้อย ได้แก่ ค่าสถานะ `--secrets-config`:
```bash
polygon-edge server --secrets-config <PATH> ...
```

พารามิเตอร์ `PATH` เป็นที่ตั้งของพารามิเตอร์ตัวจัดการข้อมูลลับที่สร้างขึ้นก่อนหน้านี้ในขั้นตอนที่ 1