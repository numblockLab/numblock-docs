---
id: syncer
title: Syncer
description: คำอธิบายเกี่ยวกับโมดูล Syncer ของ Polygon Edge
keywords:
  - docs
  - polygon
  - edge
  - architecture
  - module
  - synchronization
---

## ภาพรวม {#overview}

โมดูลนี้มีลอจิกสำหรับโปรโตคอลการซิงค์ใช้สำหรับซิงค์โหนดใหม่กับเครือข่ายที่ทำงานอยู่ หรือตรวจสอบความถูกต้อง/แทรกบล็อกใหม่สำหรับโหนดที่ไม่เข้าร่วมในฉันทามติ (ไม่ใช่ตัวตรวจสอบความถูกต้อง)

Polygon Edge ใช้ **libp2p** เป็นเลเยอร์เครือข่าย และเรียกใช้ **gRPC**

โดยหลักแล้ว Polygon Edge มีการซิงค์ 2 ประเภท:
* ซิงค์เป็นกลุ่ม - ซิงค์บล็อกจำนวนมากพร้อมกัน
* ซิงค์แบบเฝ้าดู - ซิงค์แบบบล็อกต่อบล็อก

### ซิงค์เป็นกลุ่ม {#bulk-sync}

ขั้นตอนสำหรับการซิงค์เป็นกลุ่มค่อนข้างตรงไปตรงมาในด้านการรองรับเป้าหมายของการซิงค์เป็นกลุ่ม นั่นคือการซิงค์บล็อกให้มากที่สุด (เท่าที่มี) จากเพียร์อื่นเพื่อให้ตามทันโดยเร็วที่สุด

นี่คือขั้นตอนการประมวลผลของการซิงค์เป็นกลุ่ม:

1. ** กำหนดว่าโหนดต้องซิงค์เป็นกลุ่มหรือไม่ ** - ในขั้นตอนนี้ โหนดจะตรวจสอบเพียร์แมปเพื่อดูว่า มีใครที่มีจำนวนบล็อกมากกว่าที่โหนดมีอยู่ภายในหรือไม่
2. ** หาเพียร์ที่ดีที่สุด (โดยใช้เพียร์แมปสำหรับการซิงค์) ** - ในขั้นตอนนี้ โหนดจะค้นหาเพียร์ที่ดีที่สุดที่จะซิงค์ด้วยตามเกณฑ์ที่กล่าวถึงในตัวอย่างข้างต้น
3. ** เปิดสตรีมการซิงค์เป็นกลุ่ม ** - ในขั้นตอนนี้ โหนดจะเปิดสตรีม gRPC ไปยังเพียร์ที่ดีที่สุดเพื่อทำการซิงค์บล็อกจำนวนมากจากหมายเลขบล็อกทั่วไป
4. ** เพียร์ที่ดีที่สุดปิดสตรีมเมื่อทำการส่งจำนวนมากเสร็จแล้ว ** - ในขั้นตอนนี้ เพียร์ที่ดีที่สุดที่โหนดกำลังซิงค์ด้วยจะปิดสตรีมทันทีที่ส่งบล็อกที่มีอยู่ทั้งหมดที่มี
5. ** เมื่อทำการซิงค์เป็นกลุ่มเสร็จแล้ว จะตรวจสอบว่าโหนดเป็นตัวตรวจสอบความถูกต้องหรือไม่ ** - ในขั้นตอนนี้ เพียร์ที่ดีที่สุดจะทำการปิดสตรีม และโหนดต้องตรวจสอบว่าโหนดเป็นตัวตรวจสอบความถูกต้องหรือไม่หลังจากการซิงค์เป็นกลุ่ม
  * หากเป็นเช่นนั้น โหนดจะโดดออกจากสถานะซิงค์ และเริ่มเข้าร่วมในฉันทามติ
  * หากไม่เป็นเช่นนั้น โหนดจะไปต่อที่ ** ซิงค์แบบเฝ้าดู **

### ซิงค์แบบเฝ้าดู {#watch-sync}

:::info
ขั้นตอนสำหรับการซิงค์แบบเฝ้าดูจะได้รับการดำเนินการก็ต่อเมื่อโหนดไม่ใช่ตัวตรวจสอบความถูกต้อง แต่เป็นโหนดที่ไม่ใช่ตัวตรวจสอบปกติในเครือข่ายที่รอรับบล็อกขาเข้า
:::

ลักษณะการทำงานของการซิงค์แบบเฝ้าดูค่อนข้างตรงไปตรงมา โหนดได้รับการซิงค์กับส่วนที่เหลือของเครือข่ายแล้ว และจำเป็นต้องแยกวิเคราะห์เฉพาะบล็อกใหม่ที่กำลังจะเข้ามา

นี่คือขั้นตอนการประมวลผลของการซิงค์แบบเฝ้าดู:

1. ** เพิ่มบล็อกใหม่เมื่อมีการอัปเดตสถานะของเพียร์ ** - ในขั้นตอนนี้ โหนดจะรอรับอีเวนต์บล็อกใหม่ และเมื่อมีบล็อกใหม่ จะมีการเรียกใช้ฟังก์ชัน gRPC รับบล็อก และอัปเดตสถานะภายใน
2. ** ตรวจสอบว่าโหนดเป็นตัวตรวจสอบความถูกต้องหรือไม่หลังจากซิงค์บล็อกล่าสุด **
   * ถ้าเป็น จะออกจากสถานะซิงค์
   * ถ้าไม่เป็น จะรอรับอีเวนต์บล็อกใหม่ๆ ต่อไป

## รายงานประสิทธิภาพ {#perfomance-report}

:::info
วัดประสิทธิภาพในเครื่องภายในโดยการซิงค์บล็อก ** 1 ล้านบล็อก **
:::

| ชื่อ | ผล |
|----------------------|----------------|
| การซิงค์ 1 ล้านบล็อก | ประมาณ 25 นาที |
| การโอน 1 ล้านบล็อก | ประมาณ 1 นาที |
| จำนวนการเรียก GRPC | 2 |
| การครอบคลุมของการทดสอบ | ประมาณ 93% |