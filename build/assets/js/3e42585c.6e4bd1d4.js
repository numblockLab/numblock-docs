"use strict";(self.webpackChunknumblock_docs=self.webpackChunknumblock_docs||[]).push([[4111],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),s=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=s(e.components);return r.createElement(c.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=s(t),h=a,m=d["".concat(c,".").concat(h)]||d[h]||u[h]||o;return t?r.createElement(m,l(l({ref:n},p),{},{components:t})):r.createElement(m,l({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=h;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[d]="string"==typeof e?e:a,l[1]=i;for(var s=2;s<o;s++)l[s]=t[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}h.displayName="MDXCreateElement"},1739:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>s});var r=t(7462),a=(t(7294),t(3905));const o={id:"setup",title:"Setup"},l=void 0,i={unversionedId:"developers/bridges/chainbridge/setup",id:"developers/bridges/chainbridge/setup",title:"Setup",description:"Contracts deployment",source:"@site/docs/developers/bridges/chainbridge/setup.md",sourceDirName:"developers/bridges/chainbridge",slug:"/developers/bridges/chainbridge/setup",permalink:"/docs/developers/bridges/chainbridge/setup",draft:!1,tags:[],version:"current",frontMatter:{id:"setup",title:"Setup"},sidebar:"develop",previous:{title:"General Definitions",permalink:"/docs/developers/bridges/chainbridge/definitions"},next:{title:"NRC-20 Token Transfer",permalink:"/docs/developers/bridges/chainbridge/setup-nrc20-transfer"}},c={},s=[{value:"Contracts deployment",id:"contracts-deployment",level:2},{value:"Relayer setup",id:"relayer-setup",level:2}],p={toc:s};function d(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"contracts-deployment"},"Contracts deployment"),(0,a.kt)("p",null,"In this section, you will deploy the required contracts to the NumBlock Testnet and local chain with ",(0,a.kt)("inlineCode",{parentName:"p"},"cb-sol-cli"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Setup for cb-sol-cli command\n$ git clone https://github.com/ChainSafe/chainbridge-deploy.git\n$ cd chainbridge-deploy/cb-sol-cli\n$ make install\n")),(0,a.kt)("p",null,"Firstly, we will deploy contracts to the NumBlock Testnet by ",(0,a.kt)("inlineCode",{parentName:"p"},"cb-sol-cli deploy")," command.  ",(0,a.kt)("inlineCode",{parentName:"p"},"--all")," flag makes the command deploy all the contracts, including Bridge, NRC-20 Handler, NRC-721 Handler, Generic Handler, NRC-20, and NRC-721 contract. In addition, it'll set the default relayer account address and the threshold"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Deploy all required contracts into NumBlock Testnet\n$ cb-sol-cli deploy --all --chainId 100 \\\n  --url https://rpc-testnet.numblock.org \\\n  --gasPrice [GAS_PRICE] \\\n  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \\\n  --relayers [RELAYER_ACCOUNT_ADDRESS] \\\n  --relayerThreshold 1\n")),(0,a.kt)("p",null,"Learn about chainID and JSON-RPC URL ",(0,a.kt)("a",{parentName:"p",href:"/docs/developers/bridges/chainbridge/definitions"},"here")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The default gas price in ",(0,a.kt)("inlineCode",{parentName:"p"},"cb-sol-cli")," is ",(0,a.kt)("inlineCode",{parentName:"p"},"20000000")," (",(0,a.kt)("inlineCode",{parentName:"p"},"0.02 Gwei"),"). To set the appropriate gas price in a transaction, please set the value using the ",(0,a.kt)("inlineCode",{parentName:"p"},"--gasPrice")," argument."),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ cb-sol-cli deploy --all --chainId 100 \\\n  --url https://rpc-testnet.numblock.org \\\n  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \\\n  --relayers [RELAYER_ACCOUNT_ADDRESS] \\\n  --relayerThreshold 1 \\\n  # Set gas price to 5 Gwei\n  --gasPrice 5000000000\n"))),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The Bridge contract takes approximately 0x3f97b8 (4167608) gas to deploy. Please make sure the blocks being generated have enough block gas limit to contain the contract creation transaction. ")),(0,a.kt)("p",null,"Once the contracts have been deployed, you will get the following result:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"Deploying contracts...\n\u2713 Bridge contract deployed\n\u2713 NRC-20Handler contract deployed\n\u2713 NRC-721Handler contract deployed\n\u2713 GenericHandler contract deployed\n\u2713 NRC-20 contract deployed\nWARNING: Multiple definitions for safeTransferFrom\n\u2713 NRC-721 contract deployed\n\n================================================================\nUrl:        https://rpc-testnet.numblock.org\nDeployer:   <ADMIN_ACCOUNT_ADDRESS>\nGas Limit:   8000000\nGas Price:   20000000\nDeploy Cost: 0.00029065308\n\nOptions\n=======\nChain Id:    <CHAIN_ID>\nThreshold:   <RELAYER_THRESHOLD>\nRelayers:    <RELAYER_ACCOUNT_ADDRESS>\nBridge Fee:  0\nExpiry:      100\n\nContract Addresses\n================================================================\nBridge:             <BRIDGE_CONTRACT_ADDRESS>\n----------------------------------------------------------------\nNRC-20 Handler:      <NRC-20_HANDLER_CONTRACT_ADDRESS>\n----------------------------------------------------------------\nNRC-721 Handler:     <NRC-721_HANDLER_CONTRACT_ADDRESS>\n----------------------------------------------------------------\nGeneric Handler:    <GENERIC_HANDLER_CONTRACT_ADDRESS>\n----------------------------------------------------------------\nNRC-20:              <NRC-20_CONTRACT_ADDRESS>\n----------------------------------------------------------------\nNRC-721:             <NRC-721_CONTRACT_ADDRESS>\n----------------------------------------------------------------\nCentrifuge Asset:   Not Deployed\n----------------------------------------------------------------\nWETC:               Not Deployed\n================================================================\n")),(0,a.kt)("p",null,"Now we may deploy the contracts to the NumBlock chain."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Deploy all required contracts into NumBlock chain\n$ cb-sol-cli deploy --all --chainId 100 \\\n  --url http://localhost:10002 \\\n  --privateKey [ADMIN_ACCOUNT_PRIVATE_KEY] \\\n  --relayers [RELAYER_ACCOUNT_ADDRESS] \\\n  --relayerThreshold 1\n")),(0,a.kt)("p",null,"Save the terminal outputs with the deployed smart contract addresses as we will need them for the next step."),(0,a.kt)("h2",{id:"relayer-setup"},"Relayer setup"),(0,a.kt)("p",null,"In this section, you will start a relayer to exchange data between 2 chains. "),(0,a.kt)("p",null,"First, we need to clone and build the ChainBridge repository."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ git clone https://github.com/ChainSafe/ChainBridge.git\n$ cd chainBridge && make install\n")),(0,a.kt)("p",null,"Next, You need to create ",(0,a.kt)("inlineCode",{parentName:"p"},"config.json")," and set the JSON-RPC URLs, relayer address, and contracts address for each chain."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "chains": [\n    {\n      "name": "numblock",\n      "type": "ethereum",\n      "id": "100",\n      "endpoint": "https://rpc-testnet.numblock.org",\n      "from": "<RELAYER_ACCOUNT_ADDRESS>",\n      "opts": {\n        "bridge": "<BRIDGE_CONTRACT_ADDRESS>",\n        "NRC-20Handler": "<NRC-20_HANDLER_CONTRACT_ADDRESS>",\n        "NRC-721Handler": "<NRC-721_HANDLER_CONTRACT_ADDRESS>",\n        "genericHandler": "<GENERIC_HANDLER_CONTRACT_ADDRESS>",\n        "minGasPrice": "1",\n        "http": "true"\n      }\n    },\n    {\n      "name": "local",\n      "type": "ethereum",\n      "id": "100",\n      "endpoint": "http://localhost:10002",\n      "from": "<RELAYER_ACCOUNT_ADDRESS>",\n      "opts": {\n        "bridge": "<BRIDGE_CONTRACT_ADDRESS>",\n        "NRC-20Handler": "<NRC-20_HANDLER_CONTRACT_ADDRESS>",\n        "NRC-721Handler": "<NRC-721_HANDLER_CONTRACT_ADDRESS>",\n        "genericHandler": "<GENERIC_HANDLER_CONTRACT_ADDRESS>",\n        "minGasPrice": "1",\n        "http": "true"\n      }\n    }\n  ]\n}\n')),(0,a.kt)("p",null,"To start a relayer, you need to import the private key corresponding to the relayer account address. You will need to input the password when you import private key. Once the import has been successful, the key will be stored under ",(0,a.kt)("inlineCode",{parentName:"p"},"keys/<ADDRESS>.key"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Import private key and store to local with encryption\n$ chainbridge accounts import --privateKey [RELAYER_ACCOUNT_PRIVATE_KEY]\n\nINFO[11-19|07:09:01] Importing key... \nEnter password to encrypt keystore file:\n> [PASSWORD_TO_ENCRYPT_KEY]\nINFO[11-19|07:09:05] private key imported                     address=<RELAYER_ACCOUNT_ADDRESS> file=.../keys/<RELAYER_ACCOUNT_ADDRESS>.key\n")),(0,a.kt)("p",null,"Then, you can start the relayer. You will need to input the same password you chose for storing the key in the beginning."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Start relayer\n$ chainbridge --config config.json --latest\n\nINFO[11-19|07:15:19] Starting ChainBridge... \nEnter password for key ./keys/<RELAYER_ACCOUNT_ADDRESS>.key:\n> [PASSWORD_TO_DECRYPT_KEY]\nINFO[11-19|07:15:25] Connecting to ethereum chain...          chain=numblock url=<JSON_RPC_URL>\nEnter password for key ./keys/<RELAYER_ACCOUNT_ADDRESS>.key:\n> [PASSWORD_TO_DECRYPT_KEY]\nINFO[11-19|07:15:31] Connecting to ethereum chain...          chain=local url=<JSON_RPC_URL>\n")),(0,a.kt)("p",null,"Once the relayer has begun, it will start to watch new blocks on each chain."))}d.isMDXComponent=!0}}]);